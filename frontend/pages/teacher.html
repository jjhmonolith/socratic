<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>선생님 대시보드 - 소크라테스 아카데미</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/static/css/main.css?v=2">
    <link rel="stylesheet" href="/static/css/teacher.css?v=6">
</head>
<body class="modern-body">
    <div class="modern-container">
        <!-- Modern Header -->
        <header class="modern-header">
            <div class="header-content">
                <div class="brand">
                    <div class="brand-icon">🏛️</div>
                    <div class="brand-text">
                        <h1>소크라테스 아카데미</h1>
                        <span class="brand-subtitle">선생님 대시보드</span>
                    </div>
                </div>
                <div class="header-actions">
                    <button id="createSessionBtn" class="primary-button">
                        <span class="button-icon">✨</span>
                        <span class="button-text">새 세션 만들기</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="modern-main">
            <!-- Dashboard View -->
            <div id="dashboardView" class="dashboard-view">
                <!-- Session Cards Section -->
                <div class="sessions-section">
                    <div class="section-header">
                        <h2>내 세션</h2>
                    </div>

                    <div class="sessions-grid" id="sessionsGrid">
                        <!-- 세션 카드들이 여기에 동적으로 로드됩니다 -->
                        <div class="empty-state">
                            <div class="empty-icon">📚</div>
                            <div class="empty-title">아직 생성된 세션이 없습니다</div>
                            <div class="empty-description">새 세션을 만들어 학생들과 함께 학습을 시작해보세요</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Session Detail View -->
            <div id="sessionDetailView" class="session-detail-view" style="display: none;">
                <div class="detail-header">
                    <button class="back-button" id="backToDashboard">
                        <span class="back-icon">←</span>
                        세션 목록으로
                    </button>
                    <div class="detail-title-section">
                        <h1 id="sessionDetailTitle">세션 상세</h1>
                    </div>
                    <div class="detail-actions">
                        <button class="action-btn primary" id="sessionQRBtn">
                            <span class="btn-icon">📱</span>
                            QR 코드
                        </button>
                    </div>
                </div>

                <div class="detail-content">
                    <!-- Session Info Cards -->
                    <div class="session-info-cards">
                        <div class="info-card">
                            <div class="info-icon">👥</div>
                            <div class="info-content">
                                <div class="info-value" id="detailStudentCount">0</div>
                                <div class="info-label">참여 학생</div>
                            </div>
                        </div>
                        <div class="info-card">
                            <div class="info-icon">⏱️</div>
                            <div class="info-content">
                                <div class="info-value" id="detailDuration">0분</div>
                                <div class="info-label">진행 시간</div>
                            </div>
                        </div>
                        <div class="info-card">
                            <div class="info-icon">📊</div>
                            <div class="info-content">
                                <div class="info-value" id="detailAvgScore">0%</div>
                                <div class="info-label">평균 점수</div>
                            </div>
                        </div>
                        <div class="info-card">
                            <div class="info-icon">💬</div>
                            <div class="info-content">
                                <div class="info-value" id="detailTotalMessages">0</div>
                                <div class="info-label">총 메시지</div>
                            </div>
                        </div>
                    </div>

                    <!-- Students Table -->
                    <div class="students-section">
                        <div class="students-header">
                            <h3>참여 학생 목록</h3>
                            <div class="students-controls">
                                <input type="text" class="search-input" placeholder="학생 이름 검색..." id="studentSearch">
                                <button class="export-btn">
                                    <span class="btn-icon">📥</span>
                                    내보내기
                                </button>
                            </div>
                        </div>

                        <div class="students-table-container">
                            <table class="students-table" id="studentsTable">
                                <thead>
                                    <tr>
                                        <th>학생 이름</th>
                                        <th>최근 점수</th>
                                        <th>메시지 수</th>
                                        <th>접속 시간</th>
                                        <th>최근 응답</th>
                                        <th>상태</th>
                                        <th>액션</th>
                                    </tr>
                                </thead>
                                <tbody id="studentsTableBody">
                                    <!-- 학생 데이터가 여기에 동적으로 로드됩니다 -->
                                </tbody>
                            </table>

                            <div class="table-empty-state" id="tableEmptyState">
                                <div class="empty-icon">👥</div>
                                <div class="empty-title">아직 참여한 학생이 없습니다</div>
                                <div class="empty-description">QR 코드를 공유하여 학생들의 참여를 기다려보세요</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- 새 세션 생성 모달 - 1단계 -->
        <div id="createSessionModal" class="modal" style="display: none;">
            <div class="modal-content large">
                <div class="modal-header">
                    <h3>✨ 새 학습 세션 만들기</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="session-setup-steps">
                        <div class="step active">
                            <div class="step-number">1</div>
                            <div class="step-label">세션 설정</div>
                        </div>
                        <div class="step-connector"></div>
                        <div class="step">
                            <div class="step-number">2</div>
                            <div class="step-label">QR 코드 생성</div>
                        </div>
                    </div>

                    <form id="sessionForm" class="learning-form">
                        <div class="form-card">
                            <!-- Title and Topic Input Section -->
                            <div class="input-section">
                                <div class="input-group">
                                    <label for="sessionTitle" class="input-label">세션 제목</label>
                                    <div class="input-wrapper">
                                        <input
                                            id="sessionTitle"
                                            name="title"
                                            class="form-input"
                                            placeholder="예: 기후변화 토론"
                                            maxlength="50"
                                            required
                                        />
                                    </div>
                                </div>
                                <div class="input-group">
                                    <label for="sessionTopic" class="input-label">학습 주제</label>
                                    <div class="input-wrapper">
                                        <textarea
                                            id="sessionTopic"
                                            name="topic"
                                            class="topic-input"
                                            placeholder="예: 기후변화의 원인과 해결책을 탐구하고 개인과 사회 차원의 대응방안을 토론해보세요"
                                            rows="3"
                                            required
                                        ></textarea>
                                    </div>
                                </div>
                            </div>

                            <!-- Options Grid -->
                            <div class="options-grid">
                                <!-- Difficulty Selection -->
                                <div class="option-card">
                                    <div class="card-header">
                                        <h3 class="card-title">학습 난이도</h3>
                                    </div>
                                    <div class="card-content">
                                        <div class="option-buttons horizontal" data-name="difficulty">
                                            <input type="radio" id="difficultyEasy" name="difficulty" value="easy">
                                            <label for="difficultyEasy" class="option-button">
                                                <div class="button-content">
                                                    <span class="button-icon">🌱</span>
                                                    <div class="button-text">
                                                        <span class="button-title">쉬움</span>
                                                        <span class="button-subtitle">기본 개념</span>
                                                    </div>
                                                </div>
                                            </label>

                                            <input type="radio" id="difficultyNormal" name="difficulty" value="normal" checked>
                                            <label for="difficultyNormal" class="option-button">
                                                <div class="button-content">
                                                    <span class="button-icon">📚</span>
                                                    <div class="button-text">
                                                        <span class="button-title">보통</span>
                                                        <span class="button-subtitle">중학생 수준</span>
                                                    </div>
                                                </div>
                                            </label>

                                            <input type="radio" id="difficultyHard" name="difficulty" value="hard">
                                            <label for="difficultyHard" class="option-button">
                                                <div class="button-content">
                                                    <span class="button-icon">🎓</span>
                                                    <div class="button-text">
                                                        <span class="button-title">어려움</span>
                                                        <span class="button-subtitle">깊이 있는 탐구</span>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                                <!-- Score Display Selection -->
                                <div class="option-card">
                                    <div class="card-header">
                                        <h3 class="card-title">학습 진행도</h3>
                                    </div>
                                    <div class="card-content">
                                        <div class="option-buttons toggle" data-name="scoreDisplay">
                                            <input type="radio" id="showScoreTrue" name="showScore" value="true" checked>
                                            <label for="showScoreTrue" class="option-button">
                                                <div class="button-content">
                                                    <span class="button-icon">📊</span>
                                                    <div class="button-text">
                                                        <span class="button-title">점수 표시</span>
                                                        <span class="button-subtitle">실시간 피드백</span>
                                                    </div>
                                                </div>
                                            </label>

                                            <input type="radio" id="showScoreFalse" name="showScore" value="false">
                                            <label for="showScoreFalse" class="option-button">
                                                <div class="button-content">
                                                    <span class="button-icon">🎯</span>
                                                    <div class="button-text">
                                                        <span class="button-title">점수 숨김</span>
                                                        <span class="button-subtitle">집중 모드</span>
                                                    </div>
                                                </div>
                                            </label>
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <!-- Start Button -->
                            <div class="action-section">
                                <button type="submit" class="primary-button">
                                    <span class="button-text">QR 코드 생성하기</span>
                                    <span class="button-arrow">→</span>
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- QR 코드 모달 - 2단계 -->
        <div id="qrModal" class="modal" style="display: none;">
            <div class="modal-content large">
                <div class="modal-header">
                    <h3>📱 학생들에게 이 QR 코드를 보여주세요!</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="qr-display">
                        <div class="qr-code-section">
                            <canvas id="qrCanvas" width="300" height="300"></canvas>
                        </div>

                        <div class="session-summary-section">
                            <div class="qr-info">
                                <div class="session-details">
                                    <div class="detail-item">
                                        <strong>🌐 직접 링크:</strong>
                                        <a id="sessionLink" href="#" target="_blank"></a>
                                    </div>
                                </div>
                            </div>
                            <div id="sessionSummary"></div>
                        </div>
                    </div>

                    <div class="modal-actions">
                        <button id="copyLinkBtn" class="secondary-button">📋 링크 복사</button>
                        <button id="downloadQRBtn" class="secondary-button">🖼️ QR 다운로드</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- 세션 모니터링 모달 -->
        <div id="monitorModal" class="modal" style="display: none;">
            <div class="modal-content large">
                <div class="modal-header">
                    <h3>📊 실시간 세션 모니터링</h3>
                    <button class="modal-close">&times;</button>
                </div>
                <div class="modal-body">
                    <div id="monitorContent">
                        <!-- 모니터링 내용이 여기에 동적으로 로드됩니다 -->
                    </div>
                </div>
            </div>
        </div>

        <!-- 로딩 오버레이 -->
        <div id="loading" class="loading-overlay" style="display: none;">
            <div class="loading-content">
                <div class="spinner"></div>
                <p>세션을 준비하고 있습니다...</p>
            </div>
        </div>
    </div>

    <script src="/static/config.js"></script>
    <script src="/static/js/shared/qr-generator.js?v=1"></script>
    <script src="/static/js/shared/session-manager.js?v=1"></script>
    <script src="/static/js/teacher-dashboard.js?v=2"></script>
</body>
</html>